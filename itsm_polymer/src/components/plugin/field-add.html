<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../../bower_components/paper-input/paper-textarea.html">
<link rel="import" href="../../../bower_components/vaadin-combo-box/vaadin-combo-box.html">
<link rel="import" href="../../../bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="../../../bower_components/paper-radio-group/paper-radio-group.html">
<link rel="import" href="../../../bower_components/paper-radio-button/paper-radio-button.html">
<link rel="import" href="field-annotation.html">

<!-- 添加字段 -->
<dom-module id="field-add">

  <template>
  <style>
    :host {
      --paper-radio-group-item-padding: 5px;
    }

    .suffix {
      display: inline-block;
    }

    .editContent {
      position: absolute;
      left: 0;
      top: 226px;
      right: 0;
      bottom: 120px;
      overflow-y: scroll;
      box-sizing: border-box;
    }

    .item {
      margin-left: 12px;
      margin-right: 12px;
    }

    .checkboxs {
      margin-top: 15px;
      margin-left: 6px;
    }

    paper-button.custom {
     --paper-button-ink-color: var(--paper-pink-a200);
     /* These could also be individually defined for each of the
       specific css classes, but we'll just do it once as an example */
     --paper-button-flat-keyboard-focus: {
       background-color: var(--paper-pink-a200);
       color: white !important;
     };
     --paper-button-raised-keyboard-focus: {
       background-color: var(--paper-pink-a200) !important;
       color: white !important;
     };
   }

    paper-button.custom:hover {
      background-color: var(--paper-indigo-100);
      color: blue;
    }

    paper-button.green {
      background-color: var(--paper-green-500);
      color: white;
      --paper-button-raised-keyboard-focus: {
        background-color: var(--paper-pink-a200) !important;
        color: white !important;
      };
    }

    .footbtn {
      margin-bottom: 50px;
      margin-top: 10px;
      text-align: center;
    }

    .footbtn paper-button {
      background-color: #333833 !important;
      color: #fff !important;
      margin:0 0 15px 15px !important;
    }


    /* mobile */
    @media (max-width: 767px) {
    }
  </style>


  <div class="editContent">
    <div class="item">
      <h5>名称、说明和字段类型</h5>
      <h6>输入字段的名称和说明，然后从提供的选项中选择字段类型</h6>
      <vaadin-combo-box id="fieldType" always-float-label label="字段类型" class="style-scope combo-box-basic-demos" value="{{fieldDemo.fieldCategory}}"></vaadin-combo-box>
      <paper-input id="fieldName" always-float-label label="字段名称" value="{{fieldDemo.name}}"></paper-input>
      <paper-textarea id="fieldDesc" always-float-label label="字段说明" value="{{fieldDemo.description}}"></paper-textarea>
      <h6>它指定字段的名称。名称必须以字母开头，并且只能包含字母、数字、下划线字符，不能包含空格。名称最多可以包含30个字符。</h6>
      <iron-pages selected="{{fieldTypeSelect}}" attr-for-selected="name">
        <div name="4">
          <h5>文本字段属性</h5>
          <h6>为要创建的文本字段指定属性</h6>
          <label id="label1">字段长度</label>
          <paper-radio-group id="fieldset" selected="a" aria-labelledby="label1">
              <paper-radio-button name="a">
                <paper-input always-float-label label="指定长度" value="{{fieldDemo.length}}" type="number">
                  <div slot="prefix"></div>
                </paper-input>
              </paper-radio-button>
            <paper-radio-button name="b">备忘录长度(最大2GB) - 可能不可搜索</paper-radio-button>
          </paper-radio-group>
          <div class="checkboxs">
            <paper-checkbox id="allowEnter" class="styled">允许回车</paper-checkbox><br>
          </div>
          <h6 id="fieldlengthdesc">如果要指定可在此字段中输入的最大字符数，请选择此项。然后输入或选择最大数。</h6>
        </div>
        <div name="32">
          <h5>日期/时间字段属性</h5>
          <h6>属性确定哪些类型的值可以存储在日期/时间字段中（日期和时间、仅日期、仅时间）</h6>
          <label id="label2">你要存储什么信息？</label><br>
          <paper-radio-group selected="{{dateselect}}" aria-labelledby="label1">
            <paper-radio-button name="a">日期和时间</paper-radio-button><br>
            <paper-radio-button name="b">仅日期</paper-radio-button><br>
            <paper-radio-button name="c">仅时间</paper-radio-button>
          </paper-radio-group>
          <iron-pages selected="{{dateselect}}" attr-for-selected="name">
            <div name="a"><h6>如果要此字段中存储日期和时间，请选择此选项。</h6></div>
            <div name="b"><h6>如果要此字段只存储日期值，请选择此选项。</h6></div>
            <div name="c"><h6>如果要此字段只存储时间值，请选择此选项。</h6></div>
          </iron-pages>
        </div>
        <div name="2"><h6>逻辑</h6></div>
        <div name="8">
          <h5>数字字段属性</h5>
          <h6>为要创建的数字字段指定属性</h6>
          <vaadin-combo-box id="local" always-float-label label="本地" class="style-scope combo-box-basic-demos" items={{numberLocal}}></vaadin-combo-box>
          <paper-input always-float-label label="全部数字" value="4" type="number"></paper-input>
          <paper-input always-float-label label="小数位" value="2" type="number" disabled></paper-input>
          <h6>货币选项</h6>
          <div class="checkboxs">
            <paper-checkbox>当做多种货币</paper-checkbox><br>
            <paper-checkbox disabled>使用自定义货币符号</paper-checkbox><br>
            <paper-input disabled label="自定义货币符号"></paper-input>
            <paper-checkbox>允许小数</paper-checkbox><br>
            <paper-checkbox>允许负数</paper-checkbox>
          </div>
        </div>
        <div name="0">
          <h5>链接字段属性</h5>
          <h6>选择要将链接字段连接到的业务对象</h6>
          <div class="checkboxs">
            <paper-checkbox disabled>启用嵌入式关系的链接字段</paper-checkbox>
            <vaadin-combo-box always-float-label label="嵌入式关系" class="style-scope combo-box-basic-demos"></vaadin-combo-box>
            <vaadin-combo-box always-float-label label="子类" class="style-scope combo-box-basic-demos"></vaadin-combo-box>
            <vaadin-combo-box always-float-label label="目的" class="style-scope combo-box-basic-demos"></vaadin-combo-box>
          </div>
        </div>
      </iron-pages>

      <h5>通用字段属性</h5>
      <h6>为要创建的字段指定通用属性</h6>
      <div class="checkboxs">
        <paper-checkbox class="styled">必填字段</paper-checkbox><br>
        <paper-checkbox class="styled">只读字段</paper-checkbox><br>
        <paper-checkbox class="styled">默认值</paper-checkbox>
        <vaadin-combo-box disabled id="defaultvalue" always-float-label label="默认值" class="style-scope combo-box-basic-demos"></vaadin-combo-box>
        <paper-checkbox disabled class="styled">创建此字段的索引</paper-checkbox>
        <h6>如果要用默认值自动填写字段(例如国家)，请选择此复选框。然后输入默认值</h6>
        <paper-checkbox class="styled">是否要启动字段编辑器</paper-checkbox>
      </div>
      <div class="footbtn">
        <paper-button on-click="_comfirmSubmit" raised>确定</paper-button>
        <paper-button raised on-click="_closeDrawer">取消</paper-button>
      </div>

    </div>
  </div>
  <slot></slot>

</template>

  <script>

    class FieldAdd extends Polymer.Element {

      static get is() { return 'field-add'; }

      static get properties() { return {
        dateselect: String,
        fieldTypeSelect: String,
        items: Array,
        numberLocal : {
          type: Array,
          value: [
            {label: '系统', value: 0},
            {label: '中文', value: 1},
            {label: '中文（中国）', value: 8},
            {label: '中文（台湾地区）', value: 2},
            {label: '中文（新加坡）', value: 3},
            {label: '中文（香港）', value: 4}
          ]
        },
        fieldDemo: {
          type: Object
        }
      }}

      static get observers() { return [
      ]}

      ready() {
        super.ready();
        this.dateselect = 'a';
        this._initConboBox_fieldType();
        this._setCheck();
        this._addEventListen();
        this._setFieldDemo("textFieldTemplate");
      }

      _closeDrawer() {
        this.dispatchEvent(new CustomEvent('drawer-close', {detail: 'editDrawer1',bubbles: true, composed: true}));
      }

      _comfirmSubmit(){
        // var node = this.$.fieldName.value;
        if (this.fieldDemo.name == '' || this.fieldDemo.name == undefined) {
          alert('字段名称不能为空！');
        } else {
          this.fieldDemo.alias = this.fieldDemo.name;
          this.dispatchEvent(new CustomEvent('add-tree-node', {detail: this.fieldDemo, bubbles: true, composed: true}));
        }
      }

      _initConboBox_fieldType(){
        // 字段类型
        var combobox1 = this.root.querySelector('#fieldType');
        combobox1.items = [
          {label: '链接', value: 0},
          {label: '数值', value: 8},
          {label: '逻辑', value: 2},
          {label: '时间', value: 32},
          {label: '文本', value: 4}
        ];
        combobox1.value = 4;
        this.fieldTypeSelect = 4;
      }

      _addEventListen(){
        var _this = this;
        var fieldType = _this.root.querySelector("#fieldType");
        $(fieldType).bind('change', function(){
          var value = fieldType.value;
          _this.fieldTypeSelect = value;
          switch (value) {
            case 4:
              _this._setFieldDemo('textFieldTemplate');
              break;
            case 8:
              _this._setFieldDemo('numberFieldTemplate');
              break;
            case 32:
              _this._setFieldDemo('timeFieldTemplate');
              break;
            default:
              break;
          }
        });

        var fieldset = _this.root.querySelector("#fieldset");
        $(fieldset).bind('click',function(){
          if (fieldset.selected == 'a') {
            _this._fieldlengthSetDesc("如果要指定可在此字段中输入的最大字符数，请选择此项。然后输入或选择最大数。");
          } else if(fieldset.selected == 'b') {
            _this._fieldlengthSetDesc("如果要指定字段可以容纳的最大字符数（最多2GB）， 请选择此选项。");
          }
        });

        var allowEnter = _this.root.querySelector("#allowEnter");
        $(allowEnter).bind('click', function(){
          _this._fieldlengthSetDesc("如果要允许在字段中输入回车，请选择此复选框。回车（ENTER 键）标志一行文子或一段的结束。");
        });
      }

      _fieldlengthSetDesc(args){
        var lengthdesc = this.root.querySelector("#fieldlengthdesc");
        $(lengthdesc).text(args);
      }

      _setCheck(){
        var _this = this;
      }

      _setFieldDemo(fieldType){
        var _this = this;
        $.getJSON('../../../data/template.json', function(data){
          _this.fieldDemo = data.fieldTemplate[fieldType];
        });
      }
    }

    customElements.define(FieldAdd.is, FieldAdd);

  </script>

</dom-module>
