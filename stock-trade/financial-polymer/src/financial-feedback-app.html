<link rel="import" href="../bower_components/polymer/polymer.html">

<link rel="import" href="news-nav.html">
<link rel="import" href="financial-footer.html">
<link rel="import" href="financial-login.html">
<link rel="import" href="financial-company.html">
<link rel="import" href="financial-contact.html">
<link rel="import" href="financial-feedbackForm.html">

<link rel="import" href="../bower_components/app-route/app-location.html">
<link rel="import" href="../bower_components/app-route/app-route.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../bower_components/iron-selector/iron-selector.html">

<dom-module id="financial-feedback-app">
  <template>
      <style >
        :host {
          display: block;
          color:#0000ff;
          margin:30px auto;
          padding:0;
          height:auto;
        }
      </style>
      <app-location route="{{route}}"></app-location>
      <app-route
          route="{{route}}"
          pattern="/:page"
          data="{{routeData}}"
          tail="{{subroute}}"></app-route>
      <app-route
          route="{{subroute}}"
          pattern="/:id"
          data="{{subrouteData}}"></app-route>
      <!-- <news-nav
          id="nav"
          page="[[page]]"
          categories="[[categories]]"
          category="[[category]]"
          load-complete="[[loadComplete]]">
      </news-nav> -->

     <iron-pages role="main" selected="[[page]]" attr-for-selected="name" fallback-selection="path-warning">
       <financial-registerForm
         name="signUp"
         login= "[[appData]]"
       >
      </financial-registerForm>
       <financial-login
         name="login"
         login= "[[appData]]"
       >
       </financial-login>
       <financial-company
         name="company"
         route="[[subroute]]"
         >
       </financial-company>
       <financial-contact
         name="contact"
         route="[[subroute]]"
       >
      </financial-contact>
      <financial-feedbackForm
         name="feedback"
         route="[[subroute]]"
      >
      </financial-feedbackForm>

     <news-path-warning name="path-warning"></news-path-warning>
     </iron-pages>
    <financial-footer></financial-footer>
  </template>

  <script>
  Polymer({
    is: 'financial-feedback-app',
    properties:{
      page: {
         type: String,
         reflectToAttribute: true,
         observer: '_pageChanged'
       },
       notice: String
     },
     observers: [
       '_routePageChanged(subrouteData.id)',
     ],
     _routePageChanged:function(page){
       console.log("page3333--:",page);
       // if (!page) {
       //   this.set('route.path', '/test/home/signUp');
       //   return;
       // }
       this.page = page;
       this.pagepath =  this.route.path;
       var remainingPieces = this.pagepath.split('/');
       this.page = remainingPieces[3];//这种是对应 this.set('route.path', 'instantloading/lala/home');
       if(!this.page){
           page = this.page;
           console.log("new page3333:",page);
       }
     },
     _pageChanged: function(page, oldPage) {
       var href;
       var path = this.route.path;

       console.log("this.route.path33333:"+path);
       switch(page) {
          case 'login':
            href = 'financial-login.html';
            break;
          case 'company':
            href = 'financial-company.html';
            break;
          case 'contact':
            href = 'financial-contact.html';
            break;
          case 'home':
            href = 'financial-login.html';
            break;
         case 'signUp':
            href = 'financial-registerForm.html';
            break;
         case 'feedback':
            href = 'financial-feedbackForm.html';
            break;
          default:
            href = 'news-path-warning.html';
            break;
        };
       this.importHref(
           this.resolveUrl(href),
           null,
           null,
           true);
     },
  });
  </script>
  </dom-module>
